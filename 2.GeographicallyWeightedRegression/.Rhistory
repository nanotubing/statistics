summary(lm01)
summary(lm01$residuals)
#add residuals to the kentucky data frame
kentucky$lm01resid<-residuals(lm01)
#plot residuals (plot2)
pdf(file = "lm01residchoropleth.pdf")
lm01residshades = auto.shading(kentucky$lm01resid, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Residuals from Linear Model 1")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
dev.off()
#neighbor plot with distances
kentucky_neighbors <- poly2nb(kentucky)
pdf(file = "weightedneighborplot.pdf")
plot(kentucky, main = "Weighted Neighbor plot of Kentucky Broadband Adoption ")
plot(kentucky_neighbors, coordinates(kentucky), add=T, col='blue')
dev.off()
#Lagged Means
KY_Neigh_lw <- nb2listw(kentucky_neighbors)
bband <- adopt05
bband_lagged_mean <- lag.listw(KY_Neigh_lw, bband)
par(mar = c(2,4,4,2))
pdf(file="lagged_means_choropleth.pdf")
laggedmeanshades = auto.shading(bband_lagged_mean, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, bband_lagged_mean, shading =laggedmeanshades)
title("Lagged Means plot of Kentucky Broadband Adoption")
choro.legend(3751596,4833529, laggedmeanshades, title = "Lagged Means")
dev.off()
#Moran's I - Claude Schrader
#I'm using the short version of adopt05 because I've already attached to the data
#frame. If you haven't done this, you probably need to use the full kentucky$adopt05 notation
#this calculates the maximum and minimum I values
moran.range <- function(lw) {
wmat <- listw2mat(lw)
return(range(eigen((wmat + t(wmat))/2)$values))
}
moran.range(KY_Neigh_lw)
#approximate test statistic using normal distribution
moran.test(adopt05, KY_Neigh_lw)
#calculate the test statistic using 10,000 random trials
moran.mc(adopt05, KY_Neigh_lw, 10000)
#this saves the plot to your working directory rather than displaying it inline
pdf(file = "moransplot.pdf")
moran.plot(adopt05, KY_Neigh_lw)
#this closes the file handle
dev.off()
#Step 5: GWR - Claude Schrader
kentucky.bw <- gwr.sel(adopt05 ~ college + hhpct_0401 + popden2000, data = kentucky, gweight = gwr.Gauss)
kentucky.gwr <- gwr(adopt05 ~ college + hhpct_0401 + popden2000, data = kentucky, bandwidth = kentucky.bw, gweight = gwr.Gauss, hatmatrix = T)
summary(kentucky.gwr)
names(kentucky.gwr)
names(kentucky.gwr$SDF)
gwr.df <- slot(kentucky.gwr$SDF, "data")
#Step 6: analyze the result of the GWR
print(kentucky.gwr)
anova(kentucky.gwr)
#Step 7: Plot Results
#spatial distribution of parameter estimates (for each X) (plot3)
pdf(file = "collegeparamchoropleth.pdf")
collegeparamshades = auto.shading(gwr.df$college, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college, shading=collegeparamshades)
title("GWR Parameter Estimate for college graduation rate")
choro.legend(3751596,4833529, collegeparamshades, title = "graduation rate")
dev.off()
pdf(file = "popdenchoropleth.pdf")
popdenparamshades = auto.shading(gwr.df$popden2000, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000, shading=popdenparamshades)
title("GWR Parameter Estimate for Population Density in 2000")
choro.legend(3751596,4833529, popdenparamshades, title = "Population Density")
dev.off()
pdf(file = "hhpctchoropleth.pdf")
hhpctshades = auto.shading(gwr.df$hhpct_0401, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$hhpct_0401, shading=hhpctshades)
title("GWR Parameter Estimate for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctshades, title = "availability")
dev.off()
#spatial distribution of local r^2 (plot4)
pdf(file = "localr2.pdf")
localr2shades = auto.shading(gwr.df$localR2, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$localR2, shading=localr2shades)
title("GWR Local R² values ")
choro.legend(3751596,4833529, localr2shades, title = "Local R²")
dev.off()
?pt()
t-test(gwr.df$popden2000)
t.test(gwr.df$popden2000)
t.test(gwr.df$popden2000)
?t.test
?t.test
?t.test
t.test(gwr.df)
?t.test
t.test(college, data = gwr.df)
t.test(gwr.df$college)
t.test(gwr.df$college)
t.test(gwr.df$college, data = gwr.df)
names(gwr.df)
names(gwr.df$college)
head(gwr.df$college)
names(kentucky.gwr)
t.test(gwr.df$college, data = kentucky.gwr$SDF)
t.test(kentucky.gwr$SDF$college, data = kentucky.gwr$SDF)
t.test(kentucky.gwr$SDF, data = kentucky.gwr$SDF)
t.test(kentucky.gwr, data = kentucky.gwr$SDF)
names(gwr.df)
gwr.df$college / gwr.df$college_se
gwr.df$college_pval <- gwr.df$college / gwr.df$college_se
gwr.df$college
gwr.df$college_se
gwr.df$college_pval
#p-values (you can recode these as below and above .05)(plot5)
gwr.df$college_pval <- gwr.df$college / gwr.df$college_se
gwr.df$popden2000_pval <- gwr.df$popden2000 / gwr.df$popden2000_se
gwr.df$hhpct_0401_pval <- gwr.df$hhpct_0401 / gwr.df$hhpct_0401_se
choropleth(kentucky, gwr.df$college_pval)
choropleth(kentucky, gwr.df$popden2000_pval)
choropleth(kentucky, gwr.df$hhpct_0401_pval)
gwr.t.adjust
install.packages("GWmodel")
gwr.t.adjust
libarary(gwmodel)
library(gwmodel)
library(GWmodel)
gwr.t.adjust
?gwr.t.adjust
?gwr.t.adjust
?pt
gwr.df$college_pval
str(gwr.df$college_pval)
gwr.df$college_pval
pt(gwr.df$college_pval, 119)
#p-values (you can recode these as below and above .05)(plot5)
gwr.df$college_tval <- gwr.df$college / gwr.df$college_se
gwr.df$college_pval <- pt(gwr.df$college_tval, 119)
gwr.df$popden2000_pval <- gwr.df$popden2000 / gwr.df$popden2000_se
gwr.df$popden2000_tval <- gwr.df$popden2000 / gwr.df$popden2000_se
gwr.df$hhpct_0401_tval <- gwr.df$hhpct_0401 / gwr.df$hhpct_0401_se
gwr.df$college_pval <- ''
gwr.df$hhpct_0401_pval <- ''
gwr.df$popden2000_pval <- ''
#p-values (you can recode these as below and above .05)(plot5)
gwr.df$college_tval <- gwr.df$college / gwr.df$college_se
gwr.df$popden2000_tval <- gwr.df$popden2000 / gwr.df$popden2000_se
gwr.df$hhpct_0401_tval <- gwr.df$hhpct_0401 / gwr.df$hhpct_0401_se
gwr.df$college_pval <- pt(gwr.df$college_tval, 119)
gwr.df$popden2000_pval <- pt(gwr.df$popden2000_tval, 119)
gwr.df$hhpct_0401_pval <- pt(gwr.df$hhpct_0401_tval, 119)
#p-values (you can recode these as below and above .05)(plot5)
gwr.df$college_tval <- gwr.df$college / gwr.df$college_se
gwr.df$college_pval <- pt(gwr.df$college_tval, 119)
gwr.df$popden2000_tval <- gwr.df$popden2000 / gwr.df$popden2000_se
gwr.df$popden2000_pval <- pt(gwr.df$popden2000_tval, 119)
gwr.df$hhpct_0401_tval <- gwr.df$hhpct_0401 / gwr.df$hhpct_0401_se
gwr.df$hhpct_0401_pval <- pt(gwr.df$hhpct_0401_tval, 119)
collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
gwr.df$college_pval
gwr.df$college_tval
gwr.df$popden2000_tval
gwr.df$popden2000_pval
gwr.df$hhpct_0401_tval
gwr.df$hhpct_0401_pval
?pt
gwr.df$college_tval
pt(gwr.df$college_tval, 119, lower.tail = FALSE)
gwr.df$college_pval = ''
gwr.df$popden2000_pval = ''
gwr.df$hhpct_0401_pval = ''
gwr.df$college_pval <- pt(gwr.df$college_tval, 119, lower.tail = FALSE)
gwr.df$popden2000_pval <- pt(gwr.df$popden2000_tval, 119, lower.tail = FALSE)
gwr.df$hhpct_0401_pval <- pt(gwr.df$hhpct_0401_tval, 119, lower.tail = FALSE)
gwr.df$college_pval
gwr.df$popden2000_pval
gwr.df$hhpct_0401_pval
collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
collegepvalshades <- shading(c(0.005, 0.01, 0.05), cols = brewer.pal(4, "Greens"))
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
collegepvalshades <- rev(shading(c(0.005, 0.01, 0.05), cols = brewer.pal(4, "Greens")))
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
collegepvalshades
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = rev(collegepvalshades))
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
collegepvalshades <- shading(c(0.005, 0.01, 0.05), cols = rev(brewer.pal(4, "Greens")))
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
#popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=brewer.pal(5,"Greens"))
#popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
#hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
hhpctpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
names(kentucky.gwr)
#Step 6: analyze the result of the GWR
print(kentucky.gwr)
lm01
install.packages("lm.beta")
library(lm.beta)
print(lm01)
summary(lm01)
lm01.std <- lm.beta(lm01)
summary(lm01)
summary(lm01.std)
summary(lm01.std)
summary(lm01.std)
#add standardized betas
lm01.std <- lm.beta(lm01)
summary(lm01.std)
#Step 3: Visualize and explore data
#add descriptive statistics
#add a second visualization
pdf(file = "f1.adopt05histogram.pdf")
hist(adopt05, col = "lightgreen", xlim = c(0,1), main = "Figure 1: Broadband Adoption by County", xlab = "proportion of adoption")
dev.off()
#choropleth of adopt05 (plot1)
par(mar = c(0,0,0,0))
pdf(file="f2.adopt05choropleth.pdf")
adopt05.shades <- auto.shading(adopt05, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, adopt05, shading = adopt05.shades)
title("Figure 3: Kentucky Broadband Adoption")
choro.legend(3751596,4833529, adopt05.shades, title = "proportion of adoption")
map.scale(5021404, 3205804, miles2ft(200), "Miles", 5, 40)
north.arrow(5898350, 4350232, miles2ft(10))
dev.off()
#plot residuals (plot2)
pdf(file = "f3.lm01residchoropleth.pdf")
lm01residshades = auto.shading(kentucky$lm01resid, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Residuals from Linear Model 1")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
dev.off()
pdf(file = "f4.weightedneighborplot.pdf")
plot(kentucky, main = "Weighted Neighbor plot of Kentucky Broadband Adoption ")
plot(kentucky_neighbors, coordinates(kentucky), add=T, col='blue')
dev.off()
par(mar = c(2,4,4,2))
pdf(file="f5.lagged_means_choropleth.pdf")
laggedmeanshades = auto.shading(bband_lagged_mean, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, bband_lagged_mean, shading =laggedmeanshades)
title("Lagged Means plot of Kentucky Broadband Adoption")
choro.legend(3751596,4833529, laggedmeanshades, title = "Lagged Means")
dev.off()
#this saves the plot to your working directory rather than displaying it inline
pdf(file = "f6.moransplot.pdf")
moran.plot(adopt05, KY_Neigh_lw)
#this closes the file handle
dev.off()
#Step 7: Plot Results
#spatial distribution of parameter estimates (for each X) (plot3)
pdf(file = "f7.collegeparamchoropleth.pdf")
collegeparamshades = auto.shading(gwr.df$college, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college, shading=collegeparamshades)
title("GWR Parameter Estimate for College Graduation Rate")
choro.legend(3751596,4833529, collegeparamshades, title = "graduation rate")
dev.off()
pdf(file = "f8.popdenchoropleth.pdf")
popdenparamshades = auto.shading(gwr.df$popden2000, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000, shading=popdenparamshades)
title("GWR Parameter Estimate for Population Density in 2000")
choro.legend(3751596,4833529, popdenparamshades, title = "Population Density")
dev.off()
pdf(file = "f9.hhpctchoropleth.pdf")
hhpctshades = auto.shading(gwr.df$hhpct_0401, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$hhpct_0401, shading=hhpctshades)
title("GWR Parameter Estimate for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctshades, title = "availability")
dev.off()
#spatial distribution of local r^2 (plot4)
pdf(file = "f10.localr2.pdf")
localr2shades = auto.shading(gwr.df$localR2, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$localR2, shading=localr2shades)
title("GWR Local R² values")
choro.legend(3751596,4833529, localr2shades, title = "Local R²")
dev.off()
pdf(file = "f11.collegepvalchoro.pdf")
collegepvalshades <- shading(c(0.005, 0.01, 0.05), cols = rev(brewer.pal(4, "Greens")))
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
dev.off()
pdf(file = "f12.popdenpvalchoro.pdf")
popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
dev.off()
pdf(file = "f13hhpctpvalchoro.pdf")
hhpctpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
dev.off()
hist(adopt05, col = "lightgreen", xlim = c(0,1), main = "Figure 1: Broadband Adoption by County", xlab = "proportion of adoption")
title("Figure 1: Kentucky Broadband Adoption")
hist(adopt05, col = "lightgreen", xlim = c(0,1), main = "Figure 1: Broadband Adoption by County", xlab = "proportion of adoption")
lm01residshades = auto.shading(kentucky$lm01resid, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Figure 3: Residuals from regressing broadband adoption on college acceptance, population density, and broadband availability")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Figure 3: Residuals from regressing broadband adoption on multiple independant variables")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
#Step 3: Visualize and explore data
#add descriptive statistics
#add a second visualization
pdf(file = "f1.adopt05histogram.pdf")
hist(adopt05, col = "lightgreen", xlim = c(0,1), main = "Figure 1: Broadband Adoption by County", xlab = "proportion of adoption")
dev.off()
#choropleth of adopt05 (plot1)
par(mar = c(0,0,0,0))
pdf(file="f2.adopt05choropleth.pdf")
adopt05.shades <- auto.shading(adopt05, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, adopt05, shading = adopt05.shades)
title("Figure 2: Kentucky Broadband Adoption")
choro.legend(3751596,4833529, adopt05.shades, title = "proportion of adoption")
map.scale(5021404, 3205804, miles2ft(200), "Miles", 5, 40)
north.arrow(5898350, 4350232, miles2ft(10))
dev.off()
#plot residuals (plot2)
pdf(file = "f3.lm01residchoropleth.pdf")
lm01residshades = auto.shading(kentucky$lm01resid, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Figure 3: Residuals from regressing broadband adoption on multiple independant variables")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
dev.off()
pdf(file = "f4.weightedneighborplot.pdf")
plot(kentucky, main = "Figure 4: Weighted Neighbor plot of Kentucky Broadband Adoption ")
plot(kentucky_neighbors, coordinates(kentucky), add=T, col='blue')
dev.off()
par(mar = c(2,4,4,2))
pdf(file="f5.lagged_means_choropleth.pdf")
laggedmeanshades = auto.shading(bband_lagged_mean, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, bband_lagged_mean, shading =laggedmeanshades)
title("Figure 5: Lagged Means plot of Kentucky Broadband Adoption")
choro.legend(3751596,4833529, laggedmeanshades, title = "Lagged Means")
dev.off()
?moran.plot
moran.plot(adopt05, KY_Neigh_lw)
title("Figure 6: Moran's Plot")
#this saves the plot to your working directory rather than displaying it inline
pdf(file = "f6.moransplot.pdf")
moran.plot(adopt05, KY_Neigh_lw)
title("Figure 6: Moran's Plot")
#this closes the file handle
dev.off()
#Step 5: GWR - Claude Schrader
kentucky.bw <- gwr.sel(adopt05 ~ college + hhpct_0401 + popden2000, data = kentucky, gweight = gwr.Gauss)
pdf(file = "f7.collegeparamchoropleth.pdf")
collegeparamshades = auto.shading(gwr.df$college, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college, shading=collegeparamshades)
title("Figure 7: GWR Parameter Estimate for College Graduation Rate")
choro.legend(3751596,4833529, collegeparamshades, title = "graduation rate")
dev.off()
pdf(file = "f8.collegepvalchoro.pdf")
collegepvalshades <- shading(c(0.005, 0.01, 0.05), cols = rev(brewer.pal(4, "Greens")))
#collegepvalshades = auto.shading(gwr.df$college_pval, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$college_pval, shading = collegepvalshades)
title("Figure 8: P-Value for College Graduation Rate")
choro.legend(3751596,4833529, collegepvalshades, title = "p-value")
dev.off()
pdf(file = "f9.popdenchoropleth.pdf")
popdenparamshades = auto.shading(gwr.df$popden2000, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$popden2000, shading=popdenparamshades)
title("Figure 9: GWR Parameter Estimate for Population Density in 2000")
choro.legend(3751596,4833529, popdenparamshades, title = "Population Density")
dev.off()
pdf(file = "f10.popdenpvalchoro.pdf")
popdenpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#popdenpvalshades = auto.shading(gwr.df$popden2000_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$popden2000_pval, shading = popdenpvalshades)
title("Figure 10: P-Value for Population Density in 2000")
choro.legend(3751596,4833529, popdenpvalshades, title = "p-value")
dev.off()
pdf(file = "f11.hhpctchoropleth.pdf")
hhpctshades = auto.shading(gwr.df$hhpct_0401, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$hhpct_0401, shading=hhpctshades)
title("Figure 11: GWR Parameter Estimate for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctshades, title = "availability")
dev.off()
pdf(file = "f12.hhpctpvalchoro.pdf")
hhpctpvalshades = shading(c(0.005, 0.01, 0.05), cols=rev(brewer.pal(5,"Greens")))
#hhpctpvalshades = auto.shading(gwr.df$hhpct_0401_pval, cols=rev(brewer.pal(5,"Greens")))
choropleth(kentucky, gwr.df$hhpct_0401_pval, shading = hhpctpvalshades)
title("Figure 12: P-Value for Broadband Availability Rate")
choro.legend(3751596,4833529, hhpctpvalshades, title = "p-value")
dev.off()
#spatial distribution of local r^2 (plot4)
pdf(file = "f13.localr2.pdf")
localr2shades = auto.shading(gwr.df$localR2, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$localR2, shading=localr2shades)
choro.legend(3751596,4833529, localr2shades, title = "Local R²")
dev.off()
title("Figure 13: GWR Local R² values")
#spatial distribution of local r^2 (plot4)
pdf(file = "f13.localr2.pdf")
localr2shades = auto.shading(gwr.df$localR2, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, gwr.df$localR2, shading=localr2shades)
title("Figure 13: GWR Local R² values")
choro.legend(3751596,4833529, localr2shades, title = "Local R²")
dev.off()
#plot residuals (plot2)
pdf(file = "f3.lm01residchoropleth.pdf")
lm01residshades = auto.shading(kentucky$lm01resid, cols=brewer.pal(5,"Greens"))
choropleth(kentucky, kentucky$lm01resid, shading = lm01residshades)
title("Figure 3: Residuals from linear model lm01")
choro.legend(3751596,4833529, lm01residshades, title = "residuals")
dev.off()
stat.desc(adopt05)
stat.desc(adopt05)
summary(adopt05)
fivenum(adopt05)
install.packages("psych")
install.packages(doBy)
install.packages("doBy"")
install.packages("doBy")
install.packages("doBy")
library(psych)
describe.by(adopt05, college)
library(pastecs)
stat.desc(adopt05, college)
stat.desc(c(adopt05, college))
#Step 3: Visualize and explore data
#add descriptive statistics
#add a second visualization
vals <- cbind(adopt05, college, hhpct_0401, popden2000)
stat.desc(vals)
#approximate test statistic using normal distribution
moran.test(adopt05, KY_Neigh_lw)
#calculate the test statistic using 10,000 random trials
moran.mc(adopt05, KY_Neigh_lw, 10000)
names(gwr.df)
summary(lm01.std)
summary(lm01$residuals)
moran.range(KY_Neigh_lw)
#approximate test statistic using normal distribution
moran.test(adopt05, KY_Neigh_lw)
#calculate the test statistic using 10,000 random trials
moran.mc(adopt05, KY_Neigh_lw, 10000)
summary(kentucky.gwr)
names(kentucky.gwr)
names(kentucky.gwr$SDF)
#Step 6: analyze the result of the GWR
print(kentucky.gwr)
anova(kentucky.gwr)
